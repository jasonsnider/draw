var draw=function(){var t=document.querySelector("main"),e=t.offsetWidth,n=t.offsetHeight,a=document.createElement("canvas"),r=a.getContext("2d"),i=a.getBoundingClientRect(),o=0,d=0,c=0,s=0,l=0,u=0,f=!1,w=!1,h="",g=!1;return{setIsDrawing:function(t){g=t},getIsDrawing:function(){return g},getShape:function(){return h},setShape:function(t){h=t},randColor:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},setStart:function(){c=o,s=d},setEnd:function(){l=o,u=d},setXY:function(t){f=o,w=d,o=t.clientX-i.left-a.offsetLeft,d=t.clientY-i.top-a.offsetTop},writeXY:function(){document.getElementById("trackX").innerHTML="X: "+o,document.getElementById("trackY").innerHTML="Y: "+d},draw:function(){switch(r.restore(),h){case"rectangle":this.drawRect();break;case"line":this.drawLine();break;case"circle":this.drawCircle();break;case"path":this.drawPath();break;default:alert("Please choose a shape")}r.save()},drawPath:function(){r.strokeStyle=this.randColor(),r.beginPath(),r.moveTo(f,w),r.lineTo(o,d),r.stroke()},drawCircle:function(){r.strokeStyle=this.randColor(),r.fillStyle=this.randColor();var t=c-l,e=s-u,n=Math.sqrt(t*t+e*e);r.beginPath(),r.arc(c,s,n,0,2*Math.PI),r.stroke(),r.fill()},drawLine:function(){r.strokeStyle=this.randColor(),r.beginPath(),r.moveTo(c,s),r.lineTo(l,u),r.stroke()},drawRect:function(){r.fillStyle=this.randColor(),r.fillRect(c,s,l-c,u-s)},getCanvas:function(){return a},init:function(){a.width=e,a.height=n,t.appendChild(a)}}}();draw.init(),document.getElementById("btnRect").addEventListener("click",function(){draw.setShape("rectangle")}),document.getElementById("btnCircle").addEventListener("click",function(){draw.setShape("circle")}),document.getElementById("btnPath").addEventListener("click",function(){draw.setShape("path")}),document.getElementById("btnLine").addEventListener("click",function(){draw.setShape("line")}),draw.getCanvas().addEventListener("mousedown",function(){draw.setStart(),draw.setIsDrawing(!0)}),draw.getCanvas().addEventListener("mouseup",function(){draw.setEnd(),draw.draw(),draw.setIsDrawing(!1)}),draw.getCanvas().addEventListener("mousemove",function(t){draw.setXY(t),draw.writeXY(),"path"===draw.getShape()&&!0===draw.getIsDrawing()&&draw.draw()});