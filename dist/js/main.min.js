var draw=function(){var e=document.querySelector("main"),t=e.offsetWidth,n=e.offsetHeight,a=document.createElement("canvas"),i=a.getContext("2d"),r=a.getBoundingClientRect(),o=0,d=0,s=0,c=0,l=0,u=0,h=!1,f=!1,w="",g=!1;return{setIsDrawing:function(e){g=e},getIsDrawing:function(){return g},getShape:function(){return w},setShape:function(e){w=e},randColor:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},setStart:function(){s=o,c=d},setEnd:function(){l=o,u=d},setXY:function(e){h=o,f=d,o=e.clientX-r.left-a.offsetLeft,d=e.clientY-r.top-a.offsetTop},writeXY:function(){document.getElementById("trackX").innerHTML="X: "+o,document.getElementById("trackY").innerHTML="Y: "+d},draw:function(){switch(i.restore(),w){case"rectangle":this.drawRect();break;case"line":this.drawLine();break;case"circle":this.drawCircle();break;case"path":this.drawPath();break;case"triangle":this.drawTriangle();break;default:alert("Please choose a shape")}i.save()},drawPath:function(){i.strokeStyle=this.randColor(),i.beginPath(),i.moveTo(h,f),i.lineTo(o,d),i.stroke()},drawCircle:function(){i.strokeStyle=this.randColor(),i.fillStyle=this.randColor();var e=s-l,t=c-u,n=Math.sqrt(e*e+t*t);i.beginPath(),i.arc(s,c,n,0,2*Math.PI),i.stroke(),i.fill()},drawLine:function(){i.strokeStyle=this.randColor(),i.beginPath(),i.moveTo(s,c),i.lineTo(l,u),i.stroke()},drawTriangle:function(){var e=s-l,t=c-u,n=Math.sqrt(e*e+t*t),a=s+n,r=c+n;l<s&&(a=s-n),u<c&&(r=c-n),i.fillStyle=this.randColor(),i.strokeStyle=this.randColor(),i.beginPath(),i.moveTo(s,c),i.lineTo(a,r),i.lineTo(l,u),i.lineTo(s,c),i.stroke(),i.fill()},drawRect:function(){i.fillStyle=this.randColor(),i.strokeStyle=this.randColor(),i.fillRect(s,c,l-s,u-c)},getCanvas:function(){return a},init:function(){a.width=t,a.height=n,e.appendChild(a)}}}();draw.init(),document.getElementById("btnRect").addEventListener("click",function(){draw.setShape("rectangle")}),document.getElementById("btnCircle").addEventListener("click",function(){draw.setShape("circle")}),document.getElementById("btnPath").addEventListener("click",function(){draw.setShape("path")}),document.getElementById("btnTriangle").addEventListener("click",function(){draw.setShape("triangle")}),document.getElementById("btnLine").addEventListener("click",function(){draw.setShape("line")}),draw.getCanvas().addEventListener("mousedown",function(){draw.setStart(),draw.setIsDrawing(!0)}),draw.getCanvas().addEventListener("mouseup",function(){draw.setEnd(),draw.draw(),draw.setIsDrawing(!1)}),draw.getCanvas().addEventListener("mousemove",function(e){draw.setXY(e),draw.writeXY(),"path"===draw.getShape()&&!0===draw.getIsDrawing()&&draw.draw()});