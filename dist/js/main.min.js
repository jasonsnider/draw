var draw=function(){var e=document.querySelector("main"),t=e.offsetWidth,n=e.offsetHeight,r=document.createElement("canvas"),a=r.getContext("2d"),o=r.getBoundingClientRect(),i=0,l=0,d=0,c=0,s=0,u=0,g=!1,f=!1,h="",w=!1,m="",C="";return{setIsDrawing:function(e){w=e},getIsDrawing:function(){return w},getShape:function(){return h},setShape:function(e){h=e},randColor:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},setStrokeColor:function(e){m=e},setFillColor:function(e){C=e},getStrokeColor:function(){return 6<m.length?m:this.randColor()},getFillColor:function(){return 6<C.length?C:this.randColor()},setStart:function(){d=i,c=l},setEnd:function(){s=i,u=l},setXY:function(e){g=i,f=l,i=e.clientX-o.left-r.offsetLeft,l=e.clientY-o.top-r.offsetTop},writeXY:function(){document.getElementById("trackX").innerHTML="X: "+i,document.getElementById("trackY").innerHTML="Y: "+l},draw:function(){switch(a.restore(),h){case"rectangle":this.drawRect();break;case"line":this.drawLine();break;case"circle":this.drawCircle();break;case"path":this.drawPath();break;case"triangle":this.drawTriangle();break;default:alert("Please choose a shape")}a.save()},drawPath:function(){a.strokeStyle=this.getStrokeColor(),a.beginPath(),a.moveTo(g,f),a.lineTo(i,l),a.stroke()},drawCircle:function(){a.strokeStyle=this.getStrokeColor(),a.fillStyle=this.getFillColor();var e=d-s,t=c-u,n=Math.sqrt(e*e+t*t);a.beginPath(),a.arc(d,c,n,0,2*Math.PI),a.stroke(),a.fill()},drawLine:function(){a.strokeStyle=this.getStrokeColor(),a.beginPath(),a.moveTo(d,c),a.lineTo(s,u),a.stroke()},drawTriangle:function(){var e=d-s,t=c-u,n=Math.sqrt(e*e+t*t),r=d+n,o=c+n;s<d&&(r=d-n),u<c&&(o=c-n),a.fillStyle=this.getFillColor(),a.strokeStyle=this.getStrokeColor(),a.beginPath(),a.moveTo(d,c),a.lineTo(r,o),a.lineTo(s,u),a.lineTo(d,c),a.stroke(),a.fill()},drawRect:function(){a.fillStyle=this.getFillColor(),a.strokeStyle=this.getStrokeColor(),a.fillRect(d,c,s-d,u-c)},getCanvas:function(){return r},init:function(){r.width=t,r.height=n,e.appendChild(r)}}}();draw.init(),document.getElementById("btnRect").addEventListener("click",function(){draw.setShape("rectangle")}),document.getElementById("btnCircle").addEventListener("click",function(){draw.setShape("circle")}),document.getElementById("btnPath").addEventListener("click",function(){draw.setShape("path")}),document.getElementById("btnTriangle").addEventListener("click",function(){draw.setShape("triangle")}),document.getElementById("btnLine").addEventListener("click",function(){draw.setShape("line")}),draw.getCanvas().addEventListener("mousedown",function(){draw.setStart(),draw.setIsDrawing(!0)}),draw.getCanvas().addEventListener("mouseup",function(){draw.setEnd(),draw.draw(),draw.setIsDrawing(!1)}),draw.getCanvas().addEventListener("mousemove",function(e){draw.setXY(e),draw.writeXY(),"path"===draw.getShape()&&!0===draw.getIsDrawing()&&draw.draw()}),document.getElementById("strokeColor").addEventListener("change",function(){draw.setStrokeColor(document.getElementById("strokeColor").value)}),document.getElementById("randStrokeColor").addEventListener("change",function(){draw.setStrokeColor("")}),document.getElementById("fillColor").addEventListener("change",function(){draw.setFillColor(document.getElementById("fillColor").value)}),document.getElementById("randFillColor").addEventListener("change",function(){draw.setFillColor("")}),document.getElementById("btnClear").addEventListener("click",function(){draw.clear()});